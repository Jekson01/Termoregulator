<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Терморегулятор</title>
  <link rel="stylesheet" href="style.css">
  <link href="bootstrap.css" rel="stylesheet">
  <script src="jquery.js"></script>
  <script>
  $(document).ready(function() {


    var netList;
    function getNetworks() {
      $.getJSON('ajax/get-networks', function(data) {
        netList = data;
        var status = data['status'];
        var conn = data['connected'];
        var netName = data['network'];
        if (conn) {
          $("#status").text("SSID:" + netName);
        } else $("#status").text("Отключено");

        $(".newrow").remove();
        netList = data.available;
        $.each(netList, function(index) {
          var d = netList[index];
          var cl = "newrow";
          if (d['title'] === netName)
            cl = cl + " success";
          else cl = cl + " active";
          $('<tr class="'+cl+'"><td>' + (index + 1) + '</td><td>' + d['title'] +
           '</td><td><a href="#" class="wifi ' + getSignalClass(d['signal']) +'"></a></td></tr>').fadeIn('slow').appendTo("#titem");
        })

      })
    }

    $("#titem").on('click', '.newrow' ,function(){
      alert($(this).text().substring(1));
    })

    function getSignalClass(signal) {
      if (signal >= -100 && signal <= -80) {
        return 'wifi-1';
      } else if (signal > -80 && signal <= -65) {
        return 'wifi-2';
      } else if (signal > -65 && signal < -50) {
        return 'wifi-3';
      } else {
        return 'wifi-4';
      }
    }

    getNetworks();

    $("#reload").click(function() {
      getNetworks();
    })


  });
  </script>
</head>

<body>
  <nav class="navbar navbar-inverse">
    <div class="container-fluid">
      <ul class="nav navbar-nav navbar-left">
        <li><a href="index.html">Главная</a></li>
        <li><a href="wifisettings.html">Настройка Wifi</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a id="status" href="#">Link</a></li>
      </ul>
    </div>
  </nav>
  <div class="panel panel-primary container">
    <div class="panel-heading">
      <h3 class="panel-title">Доступные сети</h3>
    </div>
    <div class="panel-body">
      <table class="table table-striped table-hover ">
        <thead>
          <tr>
            <th>#</th>
            <th>SSID</th>
            <th>Уровень сигнала</th>
          </tr>
        </thead>
        <tbody id="titem">
        </tbody>
      </table>
      <input id="reload" class="btn btn-primary" type="button" value="update">
    </div>
  </div>
</body>

</html>